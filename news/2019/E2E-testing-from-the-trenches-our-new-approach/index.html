<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>E2E testing from the trenches: Our new approach</title>
    <link href="/style.css?1739285728" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/favicon.ico" />

    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    
<meta property="og:title" content="E2E testing from the trenches: Our new approach" />
<meta property="og:description" content="This article is intended to catch you up with the most important changes in our testing framework. Terms, architecture, tools, and approaches to E2E testing in Prestashop in 2019." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://build.prestashop-project.org/news/2019/E2E-testing-from-the-trenches-our-new-approach/" />
    <meta property="article:section" content="news" />
    <meta property="article:published_time" content="2019-04-03T11:00:00+02:00" />
    <meta property="article:modified_time" content="2019-04-03T11:00:00+02:00" />

  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://build.prestashop-project.org/assets/images/theme/meta-logo-build-2024.png">
<meta name="twitter:title" content="E2E testing from the trenches: Our new approach"/>
<meta name="twitter:description" content="Testing the last version of Prestashop before using it … a long story"/>
<meta name="twitter:site" content="@PrestaShopOrg"/>

		<script async src="https://www.googletagmanager.com/gtag/js?id=G-QVW3BYSGJJ"></script>
		<script>
			var doNotTrack = false;
			if (!doNotTrack) {
				window.dataLayer = window.dataLayer || [];
				function gtag(){dataLayer.push(arguments);}
				gtag('js', new Date());
				gtag('config', 'G-QVW3BYSGJJ', { 'anonymize_ip': false });
			}
		</script>
	
    
</head>


  <body>

  <header class="site-header">

  <div class="container">
    <div class="row clearfix">

      <div class="menu-button"><i class="icon icon-store"></i></div>
      <div class="search-button"><i class="icon icon-magnifying-glass"></i></div>

      <div id="logo" class="">
        
        <a href="https://build.prestashop-project.org">
          <img src="/assets/images/theme/2024-logo.svg" alt="PrestaShop Developers&#39; blog Logo">
        </a>
      </div>

      <div id="navigation" class="">
        <nav>
  <ul id="main-navigation" class="nav navbar-nav navbar-collapse">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        News <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/releases/">Latest releases</a></li>
        <li><a href="/tag/core-monthly/">Core Monthly</a></li>
        <li><a href="/tag/event/">Events &amp; Live Updates</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Project <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/8.2/">Articles on 8.2</a></li>
        <li><a href="/tag/8.1/">Articles on 8.1</a></li>
        <li><a href="/tag/8.0/">Articles on 8.0</a></li>
        <li><a href="/tag/1.7/">Articles on 1.7</a></li>
        <li><a href="/tag/1.6/">Articles on 1.6</a></li>
        <li><a href="https://nightly.prestashop-project.org">Nightly Builds</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Contribute <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/misc/contribute-to-prestashop/">Contributor's guide</a></li>
        <li><a href="http://contributors.prestashop-project.org/">Contributor's page</a></li>
        <li><a href="http://translators.prestashop.com/">Translators' page</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Learn <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/">How-tos</a></li>
        <li><a href="/tools/">Tools</a></li>
        <li><a href="https://devdocs.prestashop-project.org/">Devdocs</a></li>
        <li><a href="/news/how-to-best-contact-us/">How to best contact us</a></li>
      </ul>
    </li>
    <li class="">
      <a href="/about/">About</a>
    </li>
  </ul>
</nav>

      </div>

      <div id="algolia-container">
        <div class="aa-input-container" id="aa-input-container">
          <input type="search" id="aa-search-input" class="aa-input-search form-control" placeholder="Search..." name="search" autocomplete="off" />
        </div>
      </div>

    </div>
  </div>

</header>


    <div class="page-content">
      <div class="container">
        
  <div class="post">

      <div class="row">
        <div class="col-sm-12">

          <header class="post-header">
            <h1 class="post-title">E2E testing from the trenches: Our new approach</h1>
              
                <h3 class="post-subtitle">Testing the last version of Prestashop before using it … a long story</h3>
              
          </header>

        </div>
      </div>


      <div class="row">
        <div id="post-sidebar" class="col-md-2">

          <aside class="author">
              <div class="author-avatar clearfix">
  
  
      <a href="https://build.prestashop-project.org/authors/MehdiBadrani/">
        <img class="img-circle" src="https://avatars3.githubusercontent.com/u/29543279?s=400&amp;v=4" alt="Mehdi Badrani's picture">
      </a>
  
</div>

<div class="aside-meta">Written by</div>
<div class="author-name">
  
    <div class="author-item">
      <div class="author-display-name">
        <a href="https://build.prestashop-project.org/authors/MehdiBadrani/">Mehdi Badrani</a>
      </div>
        
          <div class="author-display-role">QA Manager</div>
        
    </div>
  
</div>

          </aside>

          <aside class="post-meta-sidebar">
              <div class="aside-meta">Published</div>
<p class="publish-date">
    Apr 3, 2019
</p>

          </aside>

          <aside class="share-buttons">
              <div class="aside-meta">Share this</div>

<a href="https://twitter.com/intent/tweet?text=E2E&#43;testing&#43;from&#43;the&#43;trenches%3A&#43;Our&#43;new&#43;approach&amp;url=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2019%2FE2E-testing-from-the-trenches-our-new-approach%2F&amp;via=PrestaShopOrg&amp;related=PrestaShopOrg" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="icon-twitter-alt"></i>
</a>

<a href="https://facebook.com/sharer.php?u=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2019%2FE2E-testing-from-the-trenches-our-new-approach%2F" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="icon-facebook-alt"></i>
</a>

          </aside>

        </div>

        <div class="col-md-10">

          <article class="post-content">

              <p>This article is intended to catch you up with the most important changes in our testing framework. Terms, architecture, tools, and approaches to E2E testing in Prestashop in 2019.</p>
<p>It combines many good practices in testing well working at Prestashop where we implemented different testing solutions for different projects and contexts. I invite you to have a look on <a href="http://build.prestashop.com/news/prestashop-test-framework/">our previous article</a> to refresh your memory.</p>
<h2 id="but-what-are-e2e-tests">But what are E2E tests?</h2>
<p>In order to test and validate each release we can consider three categories of tests, that includes:</p>
<ul>
<li><strong>Unit tests</strong>, to check input/output of our functions, methods and classes.</li>
<li><strong>Integration tests</strong>, to check that individual features work well with others.</li>
<li><strong>End-to-end tests</strong>, to check that entire features work well in terms of user’s perspective.</li>
</ul>
<p>The last one concerns the main topic in this article, we call it sometimes functional or acceptance tests but it refers to the same word: <strong>E2E tests</strong>.</p>
<p>The most important thing in testing software is to check that this is working for users. Well written E2E tests let you know if at least on piece of a feature (product page, front-office UI, database,&hellip;) is not working as expected. This is extremely valuable because it saves a lot of time by avoiding manual checks on each context and each time a change is made.</p>
<p>If you want to run the tests or have an overview of the current stack, this is explained on GitHub, in the <a href="https://github.com/PrestaShop/PrestaShop/blob/develop/tests/E2E/README.md">Test’s readme.md</a>.</p>
<h2 id="introduction-to-puppeteer">Introduction to Puppeteer</h2>
<p><a href="https://github.com/GoogleChrome/puppeteer">Puppeteer</a> is one of the most trending testing tools in the web development community and hopefully made it easier for you to test your websites.</p>
<p><img src="/assets/images/2019/03/image1.png" alt="Puppeteer&rsquo;s popularity on GitHub"></p>
<p>Puppeteer is a Node library which provides a high-level API to control Chrome or Chromium over the <a href="https://chromedevtools.github.io/devtools-protocol/">DevTools Protocol</a>. Puppeteer runs everything in a <a href="https://developers.google.com/web/updates/2017/04/headless-chrome">headless</a> (by default) Chrome instance, so you know you’ll be rendering things the same way you do in the Chrome browser, it is possible also to run it headfull. You can do anything that the tools can, and more, because now you have access to the objects that operate under the hood.</p>
<p><img src="/assets/images/2019/03/image4.png" alt="Puppeteer schema"></p>
<h2 id="how-puppeteer-tests-look-like-">How Puppeteer tests look like ?</h2>
<p>And now let’s see how we can control our browser with Puppeteer in Javascript through examples:</p>
<p>Example #1 - Take a simple screenshot in Prestashop Front Office:
How can we take a screenshot of a prestashop page in less than 10 lines of codes?
To begin create a new directory and use npm to install the Puppeteer library</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mkdir prestashopTest
</span></span><span class="line"><span class="cl">cd prestashopTest
</span></span><span class="line"><span class="cl">npm install puppeteer
</span></span></code></pre></div><p>And now create a file prestasnapshot.js and copy/paste the code below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">const puppeteer = require(&#34;puppeteer&#34;)
</span></span><span class="line"><span class="cl">const getPrestaShot = async () =&gt; {
</span></span><span class="line"><span class="cl">  const browser = await puppeteer.launch()
</span></span><span class="line"><span class="cl">  const page = await browser.newPage()
</span></span><span class="line"><span class="cl">  await page.goto(&#34;http://fo.demo.prestashop.com/&#34;)
</span></span><span class="line"><span class="cl">  await page.screenshot({ path: &#34;prestashopsnap.png&#34; })
</span></span><span class="line"><span class="cl">  await browser.close()
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">getPrestaShot()
</span></span></code></pre></div><p>Run this script on your terminal with this command line</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">node prestasnapshot.js
</span></span></code></pre></div><p>Congrats you’ve just made your first script running on Front-Office page!
Puppeteer could be also used as automation tool, so you can use it for long and recurrent manual tasks. Keep track on our next Pull requests we will share with you some interesting automation tests.</p>
<h2 id="strength-of-puppeteer">Strength of puppeteer</h2>
<p>Puppeteer is really interesting for:</p>
<ul>
<li>Catching (non visual) JS errors and not only the presence of elements in a page while running a scenario</li>
</ul>
<p><img src="/assets/images/2019/03/image2.png" alt="Errors screenshot"></p>
<ul>
<li>Natively take screenshots and or create pdf document.</li>
<li>Less NPM dependencies</li>
<li>All-in-one puppeteer (chrome and all needed packages) no selenium-standalone server required (java, selenium-standalone, webdriver, chromedriver)</li>
<li>Natively Headless &lt;3 and work well with docker (no webdriver “Error: invalid session id”)
Puppeteer launches Chromium in <a href="https://developers.google.com/web/updates/2017/04/headless-chrome">headless mode</a>, but it’s also possible to launch Chromium in headfull mode by setting the <a href="https://github.com/GoogleChrome/puppeteer/blob/v1.13.0/docs/api.md#puppeteerlaunchoptions">&lsquo;headless&rsquo; option</a> when launching a browser:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">const browser = await puppeteer.launch({headless: false}); // default is true
</span></span></code></pre></div><h2 id="why-change">Why change?</h2>
<p>Long story short: Sustainability</p>
<p>Since the official announcement of Chrome Headless, many of the industry standard libraries for automated testing have been discontinued by their maintainers like PhantomJS and Selenium IDE for Firefox which has been <a href="https://seleniumhq.wordpress.com/2017/08/09/firefox-55-and-selenium-ide/">discontinued)</a> due to lack of maintainers.</p>
<p>Puppeteer’s library is officially maintained from the Chrome DevTools team, with many contributions (see <a href="https://github.com/GoogleChrome/puppeteer/blob/master/CONTRIBUTING.md">Contributing</a>). This means it has a solid future. This also means it supports all modern JavaScript syntax available in Chrome (like async/await).</p>
<h3 id="main-selenium-stack-drawback">Main Selenium stack drawback</h3>
<p>Tests:</p>
<ul>
<li>Lot of false flags</li>
<li>Stack unstable (need many updates)</li>
<li>The headless mode seems to have some difficulties</li>
</ul>
<p>Installations and dependencies required:</p>
<ul>
<li>Selenium-standalone</li>
<li>Java</li>
<li>Chromedriver</li>
<li>Xwebdriverio</li>
</ul>
<h3 id="the-new-nightly-builds--tests-dashboard">The new Nightly Builds &amp; Tests Dashboard</h3>
<p>Aside from the classic tests, a new dashboard has been introduced recently with the automatic nightly builds. A report is joined when the testing suite was able to run. You can find it at this brand new URL:
<a href="https://nightly.prestashop-project.org/">https://nightly.prestashop-project.org/</a></p>
<p>With a quick look, you can identify if tests have been done on a successful build, how much tests failed, and there is a link to download the entire report. Once a report is open in your browser, click on the left menu icon to use the filters. There, you can find code to improve, or tests to fix ;-)</p>
<h2 id="puppeteer--mocha-in-our-e2e-stack-architecture">Puppeteer + Mocha in our E2E stack architecture</h2>
<p><img src="/assets/images/2019/03/image3.png" alt="Stack schema"></p>
<p>E2E testing is traditionally not easy to maintain, but beginning to use Chrome headless made our tests more reliable, faster and simpler here @Prestashop. It is a real pleasure to test with Puppeteer and I recommend you to try it out on your Prestashop.</p>
<p>&lt;3 From QA Team with love &lt;3</p>


          </article>

            


              <div class="post-meta">
    <div class="row">

      <div class="col-md-4">
        <ul class="details">
          <li class="hidden-md hidden-lg">Apr 3, 2019</li>

          
            <li>
              <i class="icon-tag"></i>
              
  <a class="label label-primary" href="/tag/tests/">tests</a>


            </li>
          

        </ul>
      </div>

      
          <div class="col-md-8">
  <div class="author-details">

    <div class="row">
      <div class="col-md-11 col-md-offset-1">

          
              

                <h5>About the author</h5>

                
    <h4>
      <a href="https://build.prestashop-project.org/authors/MehdiBadrani/">Mehdi Badrani</a>
      <span>QA Manager</span>
    </h4>

    





              
          

      </div>

    </div>
  </div>
</div>


<div class="newsletter-section">
  <div class="newsletter-text">
    <p>Want to stay up-to-date with the PrestaShop project and the technical development of PrestaShop?</p>
  </div>

  <div class="subscribe-btn-container">
    <a id="subscribe-button" class="btn btn-lg btn-success">Subscribe to our newsletter</a>
  </div>

  <div id="subscription-form" class="subscription-form">
    <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/embed/v2.js"></script>
    <script>
      hbspt.forms.create({
        region: "na1",
        portalId: "4323170",
        formId: "94e069e0-99ec-4c38-964a-82a27750044e"
      });
    </script>
  </div>
</div>

<script>
  document.getElementById('subscribe-button').addEventListener('click', function () {
    var formDiv = document.getElementById('subscription-form');
    formDiv.style.display = (formDiv.style.display === 'none' || formDiv.style.display === '') ? 'block' : 'none';
  });
</script>

<style>
  .newsletter-section {
    border-top: 1px solid #e8e8e8;
    padding: 20px;
    margin: 0 auto;
    text-align: center;
    display: flex; flex-direction: column;
  }

  .newsletter-text {
    margin: auto;
    max-width: 80%;
    align-content: center;
  }

  .newsletter-text p {
    font-size: 16px;
    line-height: 1.5;
    color: #595959;
  }

  .subscribe-btn-container {
    margin-bottom: 20px;
  }

  #subscription-form {
    display: none;
    margin-top: 20px;
    text-align: left;
  }
</style>
      

    </div>
  </div>


        </div>
      </div>

      <div class="row">
  <div class="col-md-12">
    <div id="disqus_thread"></div><div id="disqus_thread"></div>
        <script type="application/javascript">
          window.disqus_config = function () {
              
              
              this.page.url = 'https:\/\/build.prestashop-project.org\/news\/E2E-testing-from-the-trenches-our-new-approach';
          };
          (function() {
            if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
              document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
              return;
            }
            var d = document, s = d.createElement('script'); s.async = true;
            s.src = '//' + "prestashopbuild" + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
</div>

    </div>

      </div>
    </div>

    <footer class="site-footer">
  <div class="container">

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>Official PrestaShop project blog written by
          <a href="/authors">its members and contributors</a>.
        </p>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>
          <a href="https://www.prestashop-project.org" target="_self" title="Create your online store with PrestaShop">
            <img id="logo-dotcom" src="/assets/images/theme/2024-logo.svg" alt="Create your online store">
          </a>
        </p>
      </div>
    </div>

    <div class="row">
      <div id="social-icons" class="col-sm-12 col-md-6 col-md-offset-3">

        

        <a href="https://www.youtube.com/@prestashopproject/" title="YouTube channel">
          <i class="icon-youtube-alt"></i>
        </a>

        
        <a href="https://github.com/PrestaShop" title="GitHub repository">
          <i class="icon-github-alt"></i>
        </a>
        

        
        <a href="https://twitter.com/PrestaShopOrg" title="Twitter account">
          <i class="icon-twitter-alt"></i>
        </a>
        

        

        <a href="/feed.xml" title="RSS feed for this blog">
          <i class="icon-rss"></i>
        </a>

      </div>
    </div>

  </div>
</footer>




<script type="text/javascript" src="/js/vendors/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="/js/vendors/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/vendors/md5.js"></script>

<script type="text/javascript" src="/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
  <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
  <script type="text/javascript">

    var client = algoliasearch("17LZR6CZEL", "79e7d4e77871f415092b78b82a66eaf0");
    var index = client.initIndex('blog');

    
    autocomplete('#aa-search-input',
      { hint: false, debug: false, autoselect: false, minLength: 4 }, {
        source: autocomplete.sources.hits(index, {hitsPerPage: 6}),
        
        displayKey: 'name',
        
        templates: {
          
          suggestion: function(hit) {
            var str =
              '<a href="' + hit.url + '">' +
              '<span class="hit-title"> ' + hit._highlightResult.title.value + '</span>' +
              '</a>'
            ;

            return str;
          },
          
          empty: function() {
            return '<div class="empty-result">Sorry we couldn\'t find anything.</div>';
          },
          footer: function() {
            return '<p class="algolia-credits">Powered by <img src="/assets/images/theme/algolia.jpg"></p>';
          }
        }
      });
  </script>




  </body>

</html>

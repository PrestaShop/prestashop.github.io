<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>Critical security vulnerability in PrestaShop modules</title>
    <link href="/style.css?1682684231" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/favicon.png" />

    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    
<meta property="og:title" content="Critical security vulnerability in PrestaShop modules" />
<meta property="og:description" content="Attackers are using a vulnerability in a popular dependency used by modules to take control of PrestaShop sites. For details, please read the entire article." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://build.prestashop-project.org/news/2020/critical-security-vulnerability-in-prestashop-modules/" />
    <meta property="article:section" content="news" />
    <meta property="article:published_time" content="2020-01-07T14:15:00+01:00" />
    <meta property="article:modified_time" content="2020-01-07T14:15:00+01:00" />

  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://build.prestashop-project.org/assets/images/theme/meta-logo-build.png">
<meta name="twitter:title" content="Critical security vulnerability in PrestaShop modules"/>
<meta name="twitter:description" content="A newly found exploit could allow remote attackers to take control of your shop."/>
<meta name="twitter:site" content="@PrestaShopOrg"/>

		<script async src="https://www.googletagmanager.com/gtag/js?id=G-QVW3BYSGJJ"></script>
		<script>
			var doNotTrack = false;
			if (!doNotTrack) {
				window.dataLayer = window.dataLayer || [];
				function gtag(){dataLayer.push(arguments);}
				gtag('js', new Date());
				gtag('config', 'G-QVW3BYSGJJ', { 'anonymize_ip': false });
			}
		</script>
	
    
</head>


  <body>

  <header class="site-header">

  <div class="container">
    <div class="row clearfix">

      <div class="menu-button"><i class="icon icon-store"></i></div>
      <div class="search-button"><i class="icon icon-magnifying-glass"></i></div>

      <div id="logo" class="">
        
        <a href="https://build.prestashop-project.org">
          <img src="/assets/images/theme/new-logo.png" alt="PrestaShop Developers&#39; blog Logo">
        </a>
      </div>

      <div id="navigation" class="">
        <nav>
  <ul id="main-navigation" class="nav navbar-nav navbar-collapse">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        News <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/releases/">Latest releases</a></li>
        <li><a href="/tag/core-monthly/">Core Monthly</a></li>
        <li><a href="/tag/event/">Events &amp; Live Updates</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Project <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/8.1/">Articles on 8.1</a></li>
        <li><a href="/tag/8.0/">Articles on 8.0</a></li>
        <li><a href="/tag/1.7/">Articles on 1.7</a></li>
        <li><a href="/tag/1.6/">Articles on 1.6</a></li>
        <li><a href="https://nightly.prestashop-project.org">Nightly Builds</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Contribute <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/misc/contribute-to-prestashop/">Contributor's guide</a></li>
        <li><a href="http://contributors.prestashop-project.org/">Contributor's page</a></li>
        <li><a href="http://translators.prestashop.com/">Translators' page</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Learn <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/">How-tos</a></li>
        <li><a href="/tools/">Tools</a></li>
        <li><a href="https://devdocs.prestashop-project.org/">Devdocs</a></li>
        <li><a href="/news/how-to-best-contact-us/">How to best contact us</a></li>
      </ul>
    </li>
    <li class="">
      <a href="/about/">About</a>
    </li>
  </ul>
</nav>

      </div>

      <div id="algolia-container">
        <div class="aa-input-container" id="aa-input-container">
          <input type="search" id="aa-search-input" class="aa-input-search form-control" placeholder="Search..." name="search" autocomplete="off" />
        </div>
      </div>

    </div>
  </div>

</header>


    <div class="page-content">
      <div class="container">
        
  <div class="post">

      <div class="row">
        <div class="col-sm-12">

          <header class="post-header">
            <h1 class="post-title">Critical security vulnerability in PrestaShop modules</h1>
              
                <h3 class="post-subtitle">A newly found exploit could allow remote attackers to take control of your shop.</h3>
              
          </header>

        </div>
      </div>


      <div class="row">
        <div id="post-sidebar" class="col-md-2">

          <aside class="author">
              <div class="author-avatar clearfix">
  
  
      

      <img class="img-circle" src="/assets/images/authors/prestashop-team.png"
         alt="PrestaShop team's photo">
  
</div>

<div class="aside-meta">Written by</div>
<div class="author-name">
  
    <div class="author-item">
      <div class="author-display-name">PrestaShop team</div>
        
    </div>
  
</div>

          </aside>

          <aside class="post-meta-sidebar">
              <div class="aside-meta">Published</div>
<p class="publish-date">
    Jan 7, 2020
</p>

          </aside>

          <aside class="share-buttons">
              <div class="aside-meta">Share this</div>

<a href="https://twitter.com/intent/tweet?text=Critical&#43;security&#43;vulnerability&#43;in&#43;PrestaShop&#43;modules&amp;url=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2020%2Fcritical-security-vulnerability-in-prestashop-modules%2F&amp;via=PrestaShopOrg&amp;related=PrestaShopOrg" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="icon-twitter-alt"></i>
</a>

<a href="https://facebook.com/sharer.php?u=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2020%2Fcritical-security-vulnerability-in-prestashop-modules%2F" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="icon-facebook-alt"></i>
</a>

          </aside>

        </div>

        <div class="col-md-10">

          <article class="post-content">

              <p>Attackers are using a vulnerability in a popular dependency used by modules to take control of PrestaShop sites. For details, please read the entire article.</p>
<h2 id="whats-happening">What’s happening</h2>
<p>It has come to our attention that attackers are exploiting a vulnerability in PHPUnit to perform arbitrary code execution in servers running PrestaShop websites. The issue is fixed in PHPUnit 7.5.19 and 8.5.1. To our knowledge, all previous versions are vulnerable, at least for certain server configurations.</p>
<h2 id="how-to-tell-if-you-are-impacted">How to tell if you are impacted</h2>
<p>Connect to your shop via FTP or shell access, and look at the “vendor” directory in the main prestashop folder and inside each one of your modules:</p>
<ul>
<li>&lt;prestashop_directory&gt;/vendor</li>
<li>&lt;prestashop_directory&gt;/modules/&lt;module_name&gt;/vendor</li>
</ul>
<p>If there’s a directory called “phpunit” inside the aforementioned directories, your shop may be vulnerable.</p>
<p><strong>Warning: don&rsquo;t touch anything else or you might break your shop</strong>
Other files and folders (e.g /vendor/symfony/symfony/src/Symfony/Bridge/PhpUnit/ or .xml files) are safe, do not delete them.</p>
<h2 id="what-to-do-if-you-are-impacted">What to do if you are impacted</h2>
<p>PHPUnit is a development library and is not needed for the normal function of your site, so you can simply delete all the “phpunit” directories found above. This should help close the attack vector.</p>
<p>On a Linux server, this can be performed quickly using the following bash command line from shop&rsquo;s modules/ folder:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">find . -type d -name &#34;phpunit&#34; -exec rm -rf {} \;
</span></span></code></pre></div><p>This command requires the relevant user rights.</p>
<p>You can also delete “phpunit” folders manually via FTP.</p>
<p><strong>Be aware that even if you perform this cleanup, your shop may have already been compromised.</strong></p>
<p>According to our analysis, most attackers either place new files in the filesystem or modify existing files, like AdminLoginController.php.</p>
<p>Here’s a non-exhaustive list of known malicious files that may indicate a compromised shop:</p>
<ul>
<li>XsamXadoo_Bot.php</li>
<li>XsamXadoo_deface.php</li>
<li>0x666.php</li>
<li>f.php</li>
<li>Xsam_Xadoo.html</li>
</ul>
<p>You can check if Core PrestaShop files have been modified by looking at the “List of changed files” section at the bottom of the “Advanced Parameters &gt; Information” page in your Back Office. However, this check may not be enough since your site may have been compromised otherwise.</p>
<p>If your shop has been compromised or if you think it has been compromised:</p>
<ul>
<li>Carefully check that the attacker didn’t leave any file on your server, e.g hidden in the middle of your shop files and/or contact an expert to do it for you.</li>
<li>Consider asking all users of your shop(s) to change their password, which includes back office users but also customer accounts. Make sure no compromised file is still present in your shop before.</li>
</ul>
<p><strong>If you think your site has been hacked, contact a security expert.</strong></p>
<h2 id="prestashop-modules-impacted-by-this-vulnerability">PrestaShop modules impacted by this vulnerability</h2>
<p>Some modules are impacted:</p>
<ul>
<li>1-Click Upgrade (autoupgrade): versions 4.0 beta and later</li>
<li>Cart Abandonment Pro (pscartabandonmentpro): versions 2.0.1~2.0.2</li>
<li>Faceted Search (ps_facetedsearch): versions 2.2.1~3.0.0</li>
<li>Merchant Expertise (gamification): versions 2.1.0 and later</li>
<li>PrestaShop Checkout (ps_checkout): versions 1.0.8~1.0.9</li>
</ul>
<p>We have released updated versions for these modules which completely remove the related library from their own dependencies:</p>
<ul>
<li>1-Click upgrade: v4.10.1</li>
<li>Cart Abandonment Pro: v2.0.10</li>
<li>Faceted Search: v3.4.1</li>
<li>Merchant Expertise: v2.3.2</li>
<li>PrestaShop Checkout: v1.2.9</li>
</ul>
<p>Be aware that if you installed in the past an impacted version of those modules, PHPUnit files may still be present on your server. Only these newly released versions make sure PHPUnit is no longer present in their own vendor directory.</p>
<p>Modules and themes by other vendors may be vulnerable as well. Expect updates to follow soon.</p>
<h2 id="additional-information">Additional information</h2>
<p>A very special thank you to Francis Ladeuil who first reported this issue.</p>
<p>We have also published a <a href="https://build.prestashop.com/news/phpunit-security-issue-post-analysis/">post incident analysis</a> that you might want to read.</p>
<h2 id="faq">FAQ</h2>
<p>You can find answers to some frequent questions asked these past days.</p>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>Which PrestaShop versions are affected?</b></summary>
  All versions.
  <br>The security vulnerability impacts modules, so it can affect any version using vulnerable modules.
  <br><br>A shop powered by PS 1.6, for example, can also be vulnerable if you install a module containing the PHPUnit library.
</details>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>Should I also delete the Symfony related folder /vendor/symfony/symfony/src/Symfony/Bridge/PhpUnit/?</b></summary>
  No.
  <br>Only the folders &lt;prestashop_directory>/vendor  and &lt;prestashop_directory>/modules/&lt;module_name>/vendor can  contain the vulnerable library PHPUnit.
 The folder /vendor/symfony/symfony/src/Symfony/Bridge/PhpUnit/ is safe <b>do not delete it</b>.
</details>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>Do I need to upgrade my 1.6 to 1.7 to be safe?</b></summary>
  No.
  <br>To secure you store follow the instructions.
  <br><br>However, we always recommend using the latest version as each new version includes bug fixes and security improvements. <a href="https://www.prestashop.com/en/blog/maintenance-extension-prestashop-1-6">PrestaShop 1.6 is no longer officially maintained since July 2019</a>.
</details>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>I can't find the vendor directory in PrestaShop 1.6, where is it?</b></summary>
  On PS 1.6 you do not need to check the folder &lt;prestashop_directory>/vendor but you need to check all modules folders like this: &lt;prestashop_directory>/modules/&lt;module_name>/vendor
</details>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>Will PrestaShop release a module to fix the problem?</b></summary>
  No.
  <br>Modules cannot replace a security expert. A module can fix this particular vulnerability, but it cannot effectively clean up a site if it has been breached.
  <br><br>Please contact a security expert if you are not sure your shop is safe.
</details>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>My shop has been hacked, what should I do?</b></summary>
  Please follow the instructions detailed in the post and contact a security expert.
</details>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>Are only PrestaShop modules vulnerable?</b></summary>
  No.
  <br>Modules and themes by other vendors may be vulnerable as well. Expect updates to follow soon.
</details>
<details style="padding: .5em .5em 0;">
  <summary style="margin: -.5em -.5em 0; padding: .5em;"><b>Would it be correct to say, that if &lt;prestashop_directory>/modules/&lt;module_name>/vendor has 700 permissions, then it could not be used to exploit vulnerability described in this article?</b></summary>
  Changing the permission settings on folders will not change anything: when a visitor comes to your website, the website is executed by the web server user(s).
  <br><br>A possible working protection is to filter the access to those folders from the web with a .htaccess rule, or in a firewall.
</details>


          </article>

            


            

  <div class="post-meta">
    <div class="row">

      <div class="col-md-4">
        <ul class="details">
          <li class="hidden-md hidden-lg">Jan 7, 2020</li>

          
            <li>
              <i class="icon-tag"></i>

              
  <a class="label label-primary" href="/tag/maintenance/">maintenance</a>

  <a class="label label-primary" href="/tag/patch/">patch</a>

  <a class="label label-primary" href="/tag/modules/">modules</a>

  <a class="label label-primary" href="/tag/security/">security</a>



            </li>
          

        </ul>
      </div>

      
      <div class="col-md-8">
        <div class="author-details">

          <div class="row">
            <div class="col-md-11 col-md-offset-1">

              

                <h5>About the author</h5>

                
    <h4>
      PrestaShop team
      <span></span>
    </h4>

    
    
    
    
    
      <a class="btn btn-default btn-sm" href="https://prestashop-project.org">
        <i class="icon-home"></i> Website
      </a>
    
  


              

            </div>

          </div>
        </div>
      </div>
      

    </div>
  </div>


        </div>
      </div>

      <div class="row">
  <div class="col-md-12">
    <div id="disqus_thread"></div><div id="disqus_thread"></div>
        <script type="application/javascript">
          window.disqus_config = function () {
              
              
              this.page.url = 'https:\/\/build.prestashop-project.org\/news\/critical-security-vulnerability-in-prestashop-modules';
          };
          (function() {
            if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
              document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
              return;
            }
            var d = document, s = d.createElement('script'); s.async = true;
            s.src = '//' + "prestashopbuild" + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
</div>

    </div>

      </div>
    </div>

    <footer class="site-footer">
  <div class="container">

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>Official PrestaShop project blog written by
          <a href="/authors">its members and contributors</a>.
        </p>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>
          <a href="https://www.prestashop-project.org" target="_self" title="Create your online store with PrestaShop">
            <img id="logo-dotcom" src="/assets/images/theme/logo-prestashop-com.png" alt="Create your online store">
          </a>
        </p>
      </div>
    </div>

    <div class="row">
      <div id="social-icons" class="col-sm-12 col-md-6 col-md-offset-3">

        

        <a href="https://www.youtube.com/@prestashopproject/" title="YouTube channel">
          <i class="icon-youtube-alt"></i>
        </a>

        
        <a href="https://github.com/PrestaShop" title="GitHub repository">
          <i class="icon-github-alt"></i>
        </a>
        

        
        <a href="https://twitter.com/PrestaShopOrg" title="Twitter account">
          <i class="icon-twitter-alt"></i>
        </a>
        

        

        <a href="/feed.xml" title="RSS feed for this blog">
          <i class="icon-rss"></i>
        </a>

      </div>
    </div>

  </div>
</footer>




<script type="text/javascript" src="/js/vendors/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="/js/vendors/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/vendors/md5.js"></script>

<script type="text/javascript" src="/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
  <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
  <script type="text/javascript">

    var client = algoliasearch("17LZR6CZEL", "79e7d4e77871f415092b78b82a66eaf0");
    var index = client.initIndex('blog');

    
    autocomplete('#aa-search-input',
      { hint: false, debug: false, autoselect: false, minLength: 4 }, {
        source: autocomplete.sources.hits(index, {hitsPerPage: 6}),
        
        displayKey: 'name',
        
        templates: {
          
          suggestion: function(hit) {
            var str =
              '<a href="' + hit.url + '">' +
              '<span class="hit-title"> ' + hit._highlightResult.title.value + '</span>' +
              '</a>'
            ;

            return str;
          },
          
          empty: function() {
            return '<div class="empty-result">Sorry we couldn\'t find anything.</div>';
          },
          footer: function() {
            return '<p class="algolia-credits">Powered by <img src="/assets/images/theme/algolia.jpg"></p>';
          }
        }
      });
  </script>




  </body>

</html>

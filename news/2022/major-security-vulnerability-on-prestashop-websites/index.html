<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>Major Security Vulnerability on PrestaShop Websites</title>
    <link href="/style.css?1764688602" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/favicon.ico" />

    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    
<meta property="og:title" content="Major Security Vulnerability on PrestaShop Websites" />
<meta property="og:description" content="Attackers have found a way to use a security vulnerability to carry out arbitrary code execution in servers running PrestaShop websites. For details, please read the entire article." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://build.prestashop-project.org/news/2022/major-security-vulnerability-on-prestashop-websites/" />
    <meta property="article:section" content="news" />
    <meta property="article:published_time" content="2022-07-22T00:00:00+02:00" />
    <meta property="article:modified_time" content="2022-07-22T00:00:00+02:00" />

  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://build.prestashop-project.org/assets/images/theme/meta-logo-build-2024.png">
<meta name="twitter:title" content="Major Security Vulnerability on PrestaShop Websites"/>
<meta name="twitter:description" content="A newly found exploit could allow remote attackers to take control of your shop."/>
<meta name="twitter:site" content="@PrestaShopOrg"/>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KF9S835S');</script>

    
</head>


  <body>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KF9S835S" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

  
  <header class="site-header">

  <div class="container">
    <div class="row clearfix">

      <div class="menu-button"><i class="icon icon-store"></i></div>
      <div class="search-button"><i class="icon icon-magnifying-glass"></i></div>

      <div id="logo" class="">
        
        <a href="https://build.prestashop-project.org">
          <img src="/assets/images/theme/2024-logo.svg" alt="PrestaShop Developers&#39; blog Logo">
        </a>
      </div>

      <div id="navigation" class="">
        <nav>
  <ul id="main-navigation" class="nav navbar-nav navbar-collapse">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        News <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/releases/">Latest releases</a></li>
        <li><a href="/tag/core-monthly/">Core Monthly</a></li>
        <li><a href="/tag/event/">Events &amp; Live Updates</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Project <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/9.0/">Articles on 9.0</a></li>
        <li><a href="/tag/8.2/">Articles on 8.2</a></li>
        <li><a href="/tag/8.1/">Articles on 8.1</a></li>
        <li><a href="/tag/8.0/">Articles on 8.0</a></li>
        <li><a href="/tag/1.7/">Articles on 1.7</a></li>
        <li><a href="/tag/1.6/">Articles on 1.6</a></li>
        <li><a href="https://nightly.prestashop-project.org">Nightly Builds</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Contribute <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/misc/contribute-to-prestashop/">Contributor's guide</a></li>
        <li><a href="http://contributors.prestashop-project.org/">Contributor's page</a></li>
        <li><a href="http://translators.prestashop.com/">Translators' page</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Learn <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/">How-tos</a></li>
        <li><a href="/tools/">Tools</a></li>
        <li><a href="https://devdocs.prestashop-project.org/">Devdocs</a></li>
        <li><a href="/news/how-to-best-contact-us/">How to best contact us</a></li>
      </ul>
    </li>
    <li class="">
      <a href="/about/">About</a>
    </li>
  </ul>
</nav>

      </div>

      <div id="algolia-container">
        <div class="aa-input-container" id="aa-input-container">
          <input type="search" id="aa-search-input" class="aa-input-search form-control" placeholder="Search..." name="search" autocomplete="off" />
        </div>
      </div>

    </div>
  </div>

</header>


    <div class="page-content">
      <div class="container">
        
  <div class="post">

      <div class="row">
        <div class="col-sm-12">

          <header class="post-header">
            <h1 class="post-title">Major Security Vulnerability on PrestaShop Websites</h1>
              
                <h3 class="post-subtitle">A newly found exploit could allow remote attackers to take control of your shop.</h3>
              
          </header>

        </div>
      </div>


      <div class="row">
        <div id="post-sidebar" class="col-md-2">

          <aside class="author">
              <div class="author-avatar clearfix">
  
  
      <a href="https://build.prestashop-project.org/authors/PrestaShop/">
        <img class="img-circle" src="/assets/images/authors/prestashop-team.png" alt="PrestaShop team's picture">
      </a>
  
</div>

<div class="aside-meta">Written by</div>
<div class="author-name">
  
    <div class="author-item">
      <div class="author-display-name">
        <a href="https://build.prestashop-project.org/authors/PrestaShop/">PrestaShop team</a>
      </div>
        
    </div>
  
</div>

          </aside>

          <aside class="post-meta-sidebar">
              <div class="aside-meta">Published</div>
<p class="publish-date">
    Jul 22, 2022
</p>

          </aside>

          <aside class="share-buttons">
              <div class="aside-meta">Share this</div>

<a href="https://twitter.com/intent/tweet?text=Major&#43;Security&#43;Vulnerability&#43;on&#43;PrestaShop&#43;Websites&amp;url=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2022%2Fmajor-security-vulnerability-on-prestashop-websites%2F&amp;via=PrestaShopOrg&amp;related=PrestaShopOrg" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="icon-twitter-alt"></i>
</a>

<a href="https://facebook.com/sharer.php?u=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2022%2Fmajor-security-vulnerability-on-prestashop-websites%2F" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="icon-facebook-alt"></i>
</a>

          </aside>

        </div>

        <div class="col-md-10">

          <article class="post-content">

              <p>Attackers have found a way to use a security vulnerability to carry out arbitrary code execution in servers running PrestaShop websites. For details, please read the entire article.</p>
<h2 id="whats-happening">What&rsquo;s happening</h2>
<p>The maintainer team has been made aware that malicious actors are exploiting a combination of known and unknown security vulnerabilities to inject malicious code in PrestaShop websites, allowing them to execute arbitrary instructions, and potentially steal customer&rsquo;s payment information.</p>
<p>While investigating this attack, we found a previously unknown vulnerability chain that we are fixing. At the moment, however, we cannot be sure that it&rsquo;s the only way for them to perform the attack.
To the best of our understanding, this issue seems to concern shops based on versions 1.6.0.10 or greater, subject to SQL injection vulnerabilities. Versions 1.7.8.2 and greater are not vulnerable unless they are running a module or custom code which itself includes an SQL injection vulnerability. Note that versions 2.0.0~2.1.0 of the Wishlist (blockwishlist) module are vulnerable.</p>
<h2 id="how-the-attack-works">How the attack works</h2>
<p>The attack requires the shop to be vulnerable to SQL injection exploits. To the best of our knowledge, the latest version of PrestaShop and its modules are free from these vulnerabilities. We believe attackers are targeting shops using outdated software or modules, vulnerable third-party modules, or a yet-to-be-discovered vulnerability.</p>
<p>According to our conversations with shop owners and developers, the recurring modus operandi looks like this:</p>
<ol>
<li>The attacker submits a POST request to the endpoint vulnerable to SQL injection.</li>
<li>After approximately one second, the attacker submits a GET request to the homepage, with no parameters. This results in a PHP file called <code>blm.php</code> being created at the root of the shop&rsquo;s directory.</li>
<li>The attacker now submits a GET request to the new file that was created, <code>blm.php</code>, allowing them to execute arbitrary instructions.</li>
</ol>
<p>After the attackers successfully gained control of a shop, they injected a fake payment form on the front-office checkout page. In this scenario, shop customers might enter their credit card information on the fake form, and unknowingly send it to the attackers.</p>
<p>While this seems to be the common pattern, attackers might be using a different one, by placing a different file name, modifying other parts of the software, planting malicious code elsewhere, or even erasing their tracks once the attack has been successful.</p>
<h2 id="what-to-do-to-keep-your-shop-safe">What to do to keep your shop safe</h2>
<p>First of all, make sure that your shop and all your modules are updated to their latest version. This should prevent your shop from being exposed to known and actively exploited SQL injection vulnerabilities.</p>
<p>According to our current understanding of the exploit, attackers might be using MySQL Smarty cache storage features as part of the attack vector. This feature is rarely used and is disabled by default, but it can be enabled remotely by the attacker. Until a patch has been published, we recommend physically disabling this feature in PrestaShop&rsquo;s code in order to break the attack chain.</p>
<p>To do so, locate the file <code>config/smarty.config.inc.php</code> on your PrestaShop install, and remove lines 43-46 (PrestaShop 1.7) or 40-43 (PrestaShop 1.6):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">Configuration</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;PS_SMARTY_CACHING_TYPE&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">include</span> <span class="nx">_PS_CLASS_DIR_</span><span class="o">.</span><span class="s1">&#39;Smarty/SmartyCacheResourceMysql.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$smarty</span><span class="o">-&gt;</span><span class="na">caching_type</span> <span class="o">=</span> <span class="s1">&#39;mysql&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="how-to-tell-if-you-have-been-affected">How to tell if you have been affected</h2>
<p>Consider looking at your server&rsquo;s access log for the attack pattern explained above. This is an example shared by a community member:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- [14/Jul/2022:16:20:56 +0200] &#34;POST /modules/XXX/XXX.php HTTP/1.1&#34; 200 82772 &#34;-&#34; &#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0.1 Safari/602.2.14&#34;
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">- [14/Jul/2022:16:20:57 +0200] &#34;GET / HTTP/1.1&#34; 200 63011 &#34;-&#34; &#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.98 Safari/537.36&#34;
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">- [14/Jul/2022:16:20:58 +0200] &#34;POST /blm.php HTTP/1.1&#34; 200 82696 &#34;-&#34; &#34;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0&#34;
</span></span></code></pre></div><p>(Note: the vulnerable module&rsquo;s path has been modified for security reasons)</p>
<p>Be aware that not finding this pattern on your logs doesn&rsquo;t necessarily mean that your shop has not been affected by the attack: the complexity of the exploit means that there are several ways of performing it, and attackers might also try and hide their tracks.</p>
<p>Consider contacting a specialist to perform a full audit of your site and make sure that no file has been modified nor any malicious code has been added.</p>
<h2 id="additional-information">Additional information</h2>
<p><a href="/news/prestashop-1-7-8-7-maintenance-release/">PrestaShop 1.7.8.7</a> has been released to strengthen the MySQL Smarty cache storage against code injection attacks. Special thanks to Dominik Shaim Ulrich who first reached out to the security team and helped investigate the vulnerability.</p>
<p>We would like to take the opportunity to stress out once more the importance of keeping your system updated to prevent such attacks. This means regularly updating both your PrestaShop software and its modules, as well as your server environment.</p>
<p><em>(Note: the original article has been updated on Monday, July 25, 2022, to add information about the release of PrestaShop 1.7.8.7.)</em></p>


          </article>

            


              <div class="post-meta">
    <div class="row">

      <div class="col-md-4">
        <ul class="details">
          <li class="hidden-md hidden-lg">Jul 22, 2022</li>

          
            <li>
              <i class="icon-tag"></i>
              
  <a class="label label-primary" href="/tag/security/">security</a>


            </li>
          

        </ul>
      </div>

      
          <div class="col-md-8">
  <div class="author-details">

    <div class="row">
      <div class="col-md-11 col-md-offset-1">

          
              

                <h5>About the author</h5>

                
    <h4>
      <a href="https://build.prestashop-project.org/authors/PrestaShop/">PrestaShop team</a>
      <span></span>
    </h4>

    





              
          

      </div>

    </div>
  </div>
</div>


<div class="newsletter-section">
  <div class="newsletter-text">
    <p>Want to stay up-to-date with the PrestaShop project and the technical development of PrestaShop?</p>
  </div>

  <div class="subscribe-btn-container">
    <a id="subscribe-button" class="btn btn-lg btn-success">Subscribe to our newsletter</a>
  </div>

  <div id="subscription-form" class="subscription-form">
    <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/embed/v2.js"></script>
    <script>
      hbspt.forms.create({
        region: "na1",
        portalId: "4323170",
        formId: "94e069e0-99ec-4c38-964a-82a27750044e"
      });
    </script>
  </div>
</div>

<script>
  document.getElementById('subscribe-button').addEventListener('click', function () {
    var formDiv = document.getElementById('subscription-form');
    formDiv.style.display = (formDiv.style.display === 'none' || formDiv.style.display === '') ? 'block' : 'none';
  });
</script>

<style>
  .newsletter-section {
    border-top: 1px solid #e8e8e8;
    padding: 20px;
    margin: 0 auto;
    text-align: center;
    display: flex; flex-direction: column;
  }

  .newsletter-text {
    margin: auto;
    max-width: 80%;
    align-content: center;
  }

  .newsletter-text p {
    font-size: 16px;
    line-height: 1.5;
    color: #595959;
  }

  .subscribe-btn-container {
    margin-bottom: 20px;
  }

  #subscription-form {
    display: none;
    margin-top: 20px;
    text-align: left;
  }
</style>
      

    </div>
  </div>


        </div>
      </div>

      <div class="row">
  <div class="col-md-12">
    <div id="disqus_thread"></div><div id="disqus_thread"></div>
        <script type="application/javascript">
          window.disqus_config = function () {
              
              
              this.page.url = 'https:\/\/build.prestashop-project.org\/news\/major-security-vulnerability-on-prestashop-websites';
          };
          (function() {
            if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
              document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
              return;
            }
            var d = document, s = d.createElement('script'); s.async = true;
            s.src = '//' + "prestashopbuild" + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
</div>

    </div>

      </div>
    </div>

    <footer class="site-footer">
  <div class="container">

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>Official PrestaShop project blog written by
          <a href="/authors">its members and contributors</a>.
        </p>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>
          <a href="https://www.prestashop-project.org" target="_self" title="Create your online store with PrestaShop">
            <img id="logo-dotcom" src="/assets/images/theme/2024-logo.svg" alt="Create your online store">
          </a>
        </p>
      </div>
    </div>

    <div class="row">
      <div id="social-icons" class="col-sm-12 col-md-6 col-md-offset-3">

        

        <a href="https://www.youtube.com/@prestashopproject/" title="YouTube channel">
          <i class="icon-youtube-alt"></i>
        </a>

        
        <a href="https://github.com/PrestaShop" title="GitHub repository">
          <i class="icon-github-alt"></i>
        </a>
        

        
        <a href="https://twitter.com/PrestaShopOrg" title="Twitter account">
          <i class="icon-twitter-alt"></i>
        </a>
        

        

        <a href="/feed.xml" title="RSS feed for this blog">
          <i class="icon-rss"></i>
        </a>

      </div>
    </div>

  </div>
</footer>




<script type="text/javascript" src="/js/vendors/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="/js/vendors/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/vendors/md5.js"></script>

<script type="text/javascript" src="/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
  <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
  <script type="text/javascript">

    var client = algoliasearch("17LZR6CZEL", "79e7d4e77871f415092b78b82a66eaf0");
    var index = client.initIndex('blog');

    
    autocomplete('#aa-search-input',
      { hint: false, debug: false, autoselect: false, minLength: 4 }, {
        source: autocomplete.sources.hits(index, {hitsPerPage: 6}),
        
        displayKey: 'name',
        
        templates: {
          
          suggestion: function(hit) {
            var str =
              '<a href="' + hit.url + '">' +
              '<span class="hit-title"> ' + hit._highlightResult.title.value + '</span>' +
              '</a>'
            ;

            return str;
          },
          
          empty: function() {
            return '<div class="empty-result">Sorry we couldn\'t find anything.</div>';
          },
          footer: function() {
            return '<p class="algolia-credits">Powered by <img src="/assets/images/theme/algolia.jpg"></p>';
          }
        }
      });
  </script>



    
    <script>
      window.axeptioSettings = {
        userCookiesDomain: "prestashop-project.org",
        clientId: "6859145f7baee141c249caa3",
        cookiesVersion: "fr-eu-23-06-2025",
        googleConsentMode: {
          default: {
            analytics_storage: "denied",
            ad_storage: "denied",
            ad_user_data: "denied",
            ad_personalization: "denied",
            wait_for_update: 500
          }
        }
      };
      (function(d, s) {
        var t = d.getElementsByTagName(s)[0], e = d.createElement(s);
        e.async = true; e.src = "//static.axept.io/sdk.js";
        t.parentNode.insertBefore(e, t);
      })(document, "script");
    </script>
    
  </body>
</html>

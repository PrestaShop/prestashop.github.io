<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>Introduction to Symfony multistore configuration forms</title>
    <link href="/style.css?1694773056" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/favicon.png" />

    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    
<meta property="og:title" content="Introduction to Symfony multistore configuration forms" />
<meta property="og:description" content="With the release of PrestaShop 1.7.8, we expanded PrestaShop multistore capabilities to Symfony forms in order to build a reusable form component to make configuration forms multishop-compatible." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://build.prestashop-project.org/news/2022/multistore-configuration-forms/" />
    <meta property="article:section" content="news" />
    <meta property="article:published_time" content="2022-02-01T00:00:00+01:00" />
    <meta property="article:modified_time" content="2022-02-01T00:00:00+01:00" />

  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://build.prestashop-project.org/assets/images/theme/meta-logo-build.png">
<meta name="twitter:title" content="Introduction to Symfony multistore configuration forms"/>
<meta name="twitter:description" content="How multistore configuration forms got better with PrestaShop 1.7.8"/>
<meta name="twitter:site" content="@PrestaShopOrg"/>

		<script async src="https://www.googletagmanager.com/gtag/js?id=G-QVW3BYSGJJ"></script>
		<script>
			var doNotTrack = false;
			if (!doNotTrack) {
				window.dataLayer = window.dataLayer || [];
				function gtag(){dataLayer.push(arguments);}
				gtag('js', new Date());
				gtag('config', 'G-QVW3BYSGJJ', { 'anonymize_ip': false });
			}
		</script>
	
    
</head>


  <body>

  <div class="conference-banner">
  <a href="https://events.prestashop.com/prestashop-developer-conference/en">
    PrestaShop Developer Conference
  </a>
  <div class="container">
    <div class="conference-title">
      PrestaShop Developer Conference
    </div>
    <div class="conference-location">
      Paris, France - November 30, 2023
    </div>
    <div class="conference-slogan">
      Let's talk code, commerce and open source.
    </div>
  </div>
</div>
<header class="site-header">

  <div class="container">
    <div class="row clearfix">

      <div class="menu-button"><i class="icon icon-store"></i></div>
      <div class="search-button"><i class="icon icon-magnifying-glass"></i></div>

      <div id="logo" class="">
        
        <a href="https://build.prestashop-project.org">
          <img src="/assets/images/theme/new-logo.png" alt="PrestaShop Developers&#39; blog Logo">
        </a>
      </div>

      <div id="navigation" class="">
        <nav>
  <ul id="main-navigation" class="nav navbar-nav navbar-collapse">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        News <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/releases/">Latest releases</a></li>
        <li><a href="/tag/core-monthly/">Core Monthly</a></li>
        <li><a href="/tag/event/">Events &amp; Live Updates</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Project <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/tag/8.1/">Articles on 8.1</a></li>
        <li><a href="/tag/8.0/">Articles on 8.0</a></li>
        <li><a href="/tag/1.7/">Articles on 1.7</a></li>
        <li><a href="/tag/1.6/">Articles on 1.6</a></li>
        <li><a href="https://nightly.prestashop-project.org">Nightly Builds</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Contribute <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/misc/contribute-to-prestashop/">Contributor's guide</a></li>
        <li><a href="http://contributors.prestashop-project.org/">Contributor's page</a></li>
        <li><a href="http://translators.prestashop.com/">Translators' page</a></li>
      </ul>
    </li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        Learn <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <li><a href="/howtos/">How-tos</a></li>
        <li><a href="/tools/">Tools</a></li>
        <li><a href="https://devdocs.prestashop-project.org/">Devdocs</a></li>
        <li><a href="/news/how-to-best-contact-us/">How to best contact us</a></li>
      </ul>
    </li>
    <li class="">
      <a href="/about/">About</a>
    </li>
  </ul>
</nav>

      </div>

      <div id="algolia-container">
        <div class="aa-input-container" id="aa-input-container">
          <input type="search" id="aa-search-input" class="aa-input-search form-control" placeholder="Search..." name="search" autocomplete="off" />
        </div>
      </div>

    </div>
  </div>

</header>


    <div class="page-content">
      <div class="container">
        
  <div class="post">

      <div class="row">
        <div class="col-sm-12">

          <header class="post-header">
            <h1 class="post-title">Introduction to Symfony multistore configuration forms</h1>
              
                <h3 class="post-subtitle">How multistore configuration forms got better with PrestaShop 1.7.8</h3>
              
          </header>

        </div>
      </div>


      <div class="row">
        <div id="post-sidebar" class="col-md-2">

          <aside class="author">
              <div class="author-avatar clearfix">
  
  
      

      <img class="img-circle" src="https://avatars.githubusercontent.com/u/1784781"
         alt="Matthieu Rolland's photo">
  
</div>

<div class="aside-meta">Written by</div>
<div class="author-name">
  
    <div class="author-item">
      <div class="author-display-name">Matthieu Rolland</div>
        
          <div class="author-display-role">Core Developer</div>
        
    </div>
  
</div>

          </aside>

          <aside class="post-meta-sidebar">
              <div class="aside-meta">Published</div>
<p class="publish-date">
    Feb 1, 2022
</p>

          </aside>

          <aside class="share-buttons">
              <div class="aside-meta">Share this</div>

<a href="https://twitter.com/intent/tweet?text=Introduction&#43;to&#43;Symfony&#43;multistore&#43;configuration&#43;forms&amp;url=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2022%2Fmultistore-configuration-forms%2F&amp;via=PrestaShopOrg&amp;related=PrestaShopOrg" rel="nofollow" target="_blank" title="Share on Twitter">
    <i class="icon-twitter-alt"></i>
</a>

<a href="https://facebook.com/sharer.php?u=https%3A%2F%2Fbuild.prestashop-project.org%2Fnews%2F2022%2Fmultistore-configuration-forms%2F" rel="nofollow" target="_blank" title="Share on Facebook">
    <i class="icon-facebook-alt"></i>
</a>

          </aside>

        </div>

        <div class="col-md-10">

          <article class="post-content">

              <p>With the release of PrestaShop 1.7.8, we expanded PrestaShop multistore capabilities to Symfony forms in order to build a reusable form component to make configuration forms multishop-compatible.</p>
<p>Multishop affects a lof ot PrestaShop behaviors and components. One aspect of this feature is that user can use configuration forms to set different values for different shops, which is dealt with using shop contexts.</p>
<h2 id="what-does-this-mean">What does this mean</h2>
<p>In a configuration form, a merchant can set different values for three different shop contexts, in this order of inheritance:</p>
<ul>
<li>All shops context</li>
<li>Group shop context</li>
<li>Single shop context</li>
</ul>
<p><img src="/assets/images/2022/01/shopcontexts.png" alt="Shop contexts"></p>
<p>When a value is not set for a context, it inherits the value of the parent context. Consequently, the &ldquo;All Shops&rdquo; context values can be considered default values.</p>
<p>Product designers listened to merchants feedback and were told this mechanism was not obvious, and it was not easy to see at a glance which form fields were modified or not for the current context in the back-office.</p>
<p>We wanted to build something new to make this feature easier to use.</p>
<h2 id="our-target">Our target</h2>
<p>We set ourselves two main criteria:</p>
<ul>
<li>
<p>Improve existing User Experience for better understanding</p>
</li>
<li>
<p>Make the technical implementation as reusable as possible on existing and future configuration forms, to make sure external contributors and module developers can easily reuse it.</p>
</li>
</ul>
<h2 id="building-multistore-configuration-forms">Building multistore configuration forms</h2>
<h3 id="user-interface">User interface</h3>
<p>After numerous merchant interviews, UX designers team created mock-ups, then Product owners worked out how it should behave and wrote it down as specifications in accordance with users feedback.</p>
<p>Here is how a multistore compatible configuration form looks like since Prestashop 1.7.8:</p>
<p><img src="/assets/images/2022/01/checkbox.png" alt="Shop contexts"></p>
<p>As you can see, a checkbox appears before multistore compatible fields. When it&rsquo;s not checked and the field is greyed out, it means that the value is inherited from a parent context. When it&rsquo;s checked, the value is overridden. In our screenshot example we can see that:</p>
<ul>
<li>The &ldquo;Enable store&rdquo; and &ldquo;Maintenance IP&rdquo; fields are greyed out, and their checkboxes are unchecked: it means their values are inherited from the parent context (&ldquo;All shops&rdquo; context in this case)</li>
<li>The field &ldquo;Custom maintenance text&rdquo; is not greyed out, and its checkbox is checked: it means its value is overriding the parent context, this value is specifically defined for this context (single shop context in this case)</li>
</ul>
<p>In &ldquo;All shops&rdquo; and group context, if a child context has a field that is overridden, a dropdown is displayed next to it and informs whether the value is overridden or not for each context:</p>
<p><img src="/assets/images/2022/01/dropdown.png" alt="Shop contexts"></p>
<p>Here, we are looking at the dropdown for the field &ldquo;Maintenance IP&rdquo;, in &ldquo;All shops&rdquo; context, and we are given these pieces of information:</p>
<ul>
<li>the shop called &ldquo;Awesome store&rdquo; has an overriden value for this field, that is to say a customized value</li>
<li>the shop called &ldquo;Shop 2&rdquo; inherits the value from this context (127.0.0.1)</li>
</ul>
<p>As you see, we did not fully reinvent the feature, we kept the concept of checkboxes, but we tried to make clearer what it does with the dropdowns and by graying fields when they inherit their value from the parent context.</p>
<h3 id="looking-at-the-technical-implementation">Looking at the technical implementation</h3>
<p>On the technical side, these visual elements had to be reusable and easily implementable, without having to copy HTML or rethink the logic in the backend.</p>
<p>All the work of knowing if the value of a field is inherited or not, and saving the submitted value only for the right context should be done only once, and easily reused by external contributors.</p>
<p>For this purpose, we decided to take advantage of Symfony form extensions. To add the new checkboxes and multistore dropdowns on a configuration form, a developer simply needs to extend our multistore extension and configure each multishop field with its related configuration name, see the <a href="https://github.com/PrestaShop/PrestaShop/blob/develop/src/PrestaShopBundle/Form/Admin/Configure/ShopParameters/General/MaintenanceType.php">maintenance configuration form</a> as an example.</p>
<p>Then we added multistore helper methods for Configuration classes, to make saving data for the right context a breeze (depending on which checkboxes are checked). See how the new <code>updateConfigurationValue</code> method is used <a href="https://github.com/PrestaShop/example-modules/blob/master/demomultistoreform/src/Form/ContentBlockDataConfiguration.php">here</a>.</p>
<p>Finally, we created a new multistore Javascript component, which only needs to be instantiated in order to make the multistore form reactive. You can see it in action in <a href="https://github.com/PrestaShop/example-modules/blob/master/demomultistoreform/views/js/form.js">the multistore example module</a>.</p>
<h2 id="friendly-reminder-">Friendly reminder :)</h2>
<p>As most of you may know, PrestaShop is open source, which means you are more than welcome to contribute ! Multistore&rsquo;s technical documentation <a href="https://devdocs.prestashop.com/1.7/development/multistore/">can be found here</a>, there&rsquo;s also <a href="https://github.com/PrestaShop/example-modules/tree/master/demomultistoreform">a module example</a> showing you how you can make your configuration forms multistore compatible in your own modules.</p>
<p>Feedback is always appreciated, so don&rsquo;t hesitate to contact us on <a href="https://www.prestashop-project.org/slack/channels/">one of our Slack channels</a>, see you soon !</p>


          </article>

            


            

  <div class="post-meta">
    <div class="row">

      <div class="col-md-4">
        <ul class="details">
          <li class="hidden-md hidden-lg">Feb 1, 2022</li>

          
            <li>
              <i class="icon-tag"></i>

              
  <a class="label label-primary" href="/tag/multistore/">multistore</a>

  <a class="label label-primary" href="/tag/contribute/">contribute</a>



            </li>
          

        </ul>
      </div>

      
      <div class="col-md-8">
        <div class="author-details">

          <div class="row">
            <div class="col-md-11 col-md-offset-1">

              

                <h5>About the author</h5>

                
    <h4>
      Matthieu Rolland
      <span>Core Developer</span>
    </h4>

    
      <a class="btn btn-default btn-sm" href="https://github.com/matthieu-rolland">
        <i class="icon-github-alt"></i> GitHub
      </a>
    
    
    
    
    
      <a class="btn btn-default btn-sm" href="https://github.com/matthieu-rolland">
        <i class="icon-home"></i> Website
      </a>
    
  


              

            </div>

          </div>
        </div>
      </div>
      

    </div>
  </div>


        </div>
      </div>

      <div class="row">
  <div class="col-md-12">
    <div id="disqus_thread"></div><div id="disqus_thread"></div>
        <script type="application/javascript">
          window.disqus_config = function () {
              
              
              this.page.url = 'https:\/\/build.prestashop-project.org\/news\/multistore-configuration-forms';
          };
          (function() {
            if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
              document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
              return;
            }
            var d = document, s = d.createElement('script'); s.async = true;
            s.src = '//' + "prestashopbuild" + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
</div>

    </div>

      </div>
    </div>

    <footer class="site-footer">
  <div class="container">

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>Official PrestaShop project blog written by
          <a href="/authors">its members and contributors</a>.
        </p>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-8 col-md-offset-2">
        <p>
          <a href="https://www.prestashop-project.org" target="_self" title="Create your online store with PrestaShop">
            <img id="logo-dotcom" src="/assets/images/theme/logo-prestashop-com.png" alt="Create your online store">
          </a>
        </p>
      </div>
    </div>

    <div class="row">
      <div id="social-icons" class="col-sm-12 col-md-6 col-md-offset-3">

        

        <a href="https://www.youtube.com/@prestashopproject/" title="YouTube channel">
          <i class="icon-youtube-alt"></i>
        </a>

        
        <a href="https://github.com/PrestaShop" title="GitHub repository">
          <i class="icon-github-alt"></i>
        </a>
        

        
        <a href="https://twitter.com/PrestaShopOrg" title="Twitter account">
          <i class="icon-twitter-alt"></i>
        </a>
        

        

        <a href="/feed.xml" title="RSS feed for this blog">
          <i class="icon-rss"></i>
        </a>

      </div>
    </div>

  </div>
</footer>




<script type="text/javascript" src="/js/vendors/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="/js/vendors/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/vendors/md5.js"></script>

<script type="text/javascript" src="/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
  <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
  <script type="text/javascript">

    var client = algoliasearch("17LZR6CZEL", "79e7d4e77871f415092b78b82a66eaf0");
    var index = client.initIndex('blog');

    
    autocomplete('#aa-search-input',
      { hint: false, debug: false, autoselect: false, minLength: 4 }, {
        source: autocomplete.sources.hits(index, {hitsPerPage: 6}),
        
        displayKey: 'name',
        
        templates: {
          
          suggestion: function(hit) {
            var str =
              '<a href="' + hit.url + '">' +
              '<span class="hit-title"> ' + hit._highlightResult.title.value + '</span>' +
              '</a>'
            ;

            return str;
          },
          
          empty: function() {
            return '<div class="empty-result">Sorry we couldn\'t find anything.</div>';
          },
          footer: function() {
            return '<p class="algolia-credits">Powered by <img src="/assets/images/theme/algolia.jpg"></p>';
          }
        }
      });
  </script>




  </body>

</html>
